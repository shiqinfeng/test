<html>
<head>
  <title>FTPC操作</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601302 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="4177"/>
<h1>FTPC操作</h1>

<div>
<span><div><div>上移下移</div><div>   //下移</div><div>   </div><div>   </div><div>   function frmMoveToNext()</div><div>{</div><div>    count = activityGrid.getNumberOfRows()</div><div>    cellValue = activityGrid.getCellObject(count-1,0)</div><div>    if(cellValue instanceof Boolean &amp;&amp; cellValue != true)</div><div>    {</div><div>        for(i = count; i &gt;= 0; i--)</div><div>        {</div><div>            cellValue = activityGrid.getCellObject(i,0)</div><div>            if(cellValue instanceof Boolean)</div><div>            {</div><div>                selected = ((Boolean)cellValue).booleanValue()</div><div>                if(selected)</div><div>                {</div><div>                    activityGrid.swapRows(i,i+1)</div><div>                }</div><div>            }</div><div>        }</div><div>        grid = activityGridResult.getGrid()</div><div>        setGridSeq(grid,1)</div><div>    }</div><div>}</div><div>//上移</div><div>function frmMoveToUP()</div><div>{</div><div>    cellValue = activityGrid.getCellObject(0,0)</div><div>    if(cellValue instanceof Boolean &amp;&amp; cellValue != true)</div><div>    {</div><div>        count = activityGrid.getNumberOfRows()</div><div>        for(i = 0; i &lt; count; i++)</div><div>        {</div><div>            cellValue = activityGrid.getCellObject(i,0)</div><div>            if(cellValue instanceof Boolean)</div><div>            {</div><div>                selected = ((Boolean)cellValue).booleanValue()</div><div>                if(selected)</div><div>                {</div><div>                    activityGrid.swapRows(i,i-1)</div><div>                }</div><div>            }</div><div>        }</div><div>        grid = activityGridResult.getGrid()</div><div>        setGridSeq(grid,1)</div><div>    }</div><div>}</div><div><br/></div><div><br/></div><hr/><div>锁定解锁/冻结解冻</div><div>//冻结</div><div>function frmLock()</div><div>{</div><div>   function handleException(exception)</div><div>    {    </div><div>        //prompt message</div><div>        handleErrorMsg(&quot;MES_MAINFROM_MSG_TRX&quot;, &quot;RESEQUENCE_EXCEPTION&quot;, null, null,null, HANDLER_OPTION_DEFAULT, null)</div><div>        //print StackOverflowError</div><div>        logException(FORM_MODULE, exception)</div><div>        //log</div><div>        logError(FORM_MODULE, exception.getMessage(), createTime(), &quot;Form:&quot; + getActiveDsForm().getName(), &quot;Function:frmSave()&quot;)</div><div>    }</div><div>//     catch(Exception, handleException)</div><div>   </div><div>    count = activityGrid.getNumberOfRows()</div><div>    if(count &gt; 0)</div><div>    {</div><div>        for(i = count; i &gt;= 0; i--)</div><div>        {</div><div>          cellValue = activityGrid.getCellObject(i,0)</div><div>          if(cellValue instanceof Boolean)</div><div>          {</div><div>            selected = ((Boolean)cellValue).booleanValue()</div><div>            if(selected)</div><div>            {</div><div>                dataArray = activityGrid.getRowObject(i)</div><div>                status = dataArray.getState()</div><div>                if(status == 6)</div><div>                {     </div><div>                    keyWord = &quot;OrderName[&quot; + dataArray.getPlanNumber() + &quot;] &quot;</div><div>                    dataArray.setState(Long(&quot;5&quot;))</div><div>                    //获取当前用户名</div><div>                    dataArray.setPlanImportN(getCurrentUser().getName())</div><div>                    //获取当前时间</div><div>                    dataArray.setPlanImportT(createTime())</div><div>                    //计划版本每次修改+1</div><div>                     dataArray.setPlanVersion(Long(dataArray.getPlanVersion()+1))</div><div>                    response = dataArray.save(null,null,null)      </div><div>                }</div><div>            }</div><div>          }</div><div>        }</div><div>        frmQuery()</div><div>    }</div><div>                 </div><div>}   </div><div>//解冻</div><div>function frmUnLock()</div><div>{</div><div>   function handleException(exception)</div><div>    {    </div><div>        //prompt message</div><div>        handleErrorMsg(&quot;MES_MAINFROM_MSG_TRX&quot;, &quot;RESEQUENCE_EXCEPTION&quot;, null, null,null, HANDLER_OPTION_DEFAULT, null)</div><div>        //print StackOverflowError</div><div>        logException(FORM_MODULE, exception)</div><div>        //log</div><div>        logError(FORM_MODULE, exception.getMessage(), createTime(), &quot;Form:&quot; + getActiveDsForm().getName(), &quot;Function:frmSave()&quot;)</div><div>    }</div><div>//     catch(Exception, handleException)</div><div>   </div><div>    count = activityGrid.getNumberOfRows()</div><div>    if(count &gt; 0)</div><div>    {</div><div>        for(i = count; i &gt;= 0; i--)</div><div>        {</div><div>          cellValue = activityGrid.getCellObject(i,0)</div><div>          if(cellValue instanceof Boolean)</div><div>          {</div><div>            selected = ((Boolean)cellValue).booleanValue()</div><div>            if(selected)</div><div>            {</div><div>                dataArray = activityGrid.getRowObject(i)</div><div>                status = dataArray.getState()</div><div>                if(status == 5)</div><div>                {     </div><div>                    keyWord = &quot;OrderName[&quot; + dataArray.getPlanNumber() + &quot;] &quot;</div><div>                    dataArray.setState(Long(&quot;6&quot;))</div><div>                    dataArray.setPlanImportN(getCurrentUser().getName())</div><div>                    dataArray.setPlanImportT(createTime())</div><div>                    dataArray.setPlanVersion(Long(dataArray.getPlanVersion()+1))</div><div>                    response = dataArray.save(null,null,null)      </div><div>                }</div><div>            }</div><div>          }</div><div>        }</div><div>        frmQuery()</div><div>    }</div><div>                 </div><div>}  </div><div><br/></div><hr/><div>下拉框</div><div>function initcomboboxWorkShopForm()</div><div>{</div><div>items = createArray(3)</div><div>items = [&quot;车间一&quot;, &quot;车间二&quot;, &quot;车间三&quot;]</div><div>comboboxWorkShopForm.setItems(items)</div><div>// index = comboboxPlanAuditR.getSelectedIndex()</div><div>// comboboxPlanAuditR.getItem(index)</div><div><br/></div><div>}</div><div><br/></div></div><div><br/></div><div>-===============================================================================================</div><div>定义全局变量</div><div>function  frminit()</div><div>{</div><div>    initEnvironment()</div><div>    frmReset()</div><div>    frmInitGrid_Sell()</div><div>    frmInitGrid_Stock()</div><div>//获取页面的传值</div><div>    Object = getFormProperty(DEFAULT_OBJ)</div><div>    ProductNumber=Object.getProductNumber()  </div><div>//定义全局变量</div><div>    vectorProductionNumber = vector()</div><div>//创建新的全局对象vectorProductionNumber</div><div>    setFormProperty(&quot;vectorProductionNumber&quot;,vectorProductionNumber)</div><div>//把来的值放人创建的vectorProductionNumber对象中</div><div>    vectorProductionNumber.add(ProductNumber)</div><div><br/></div><div>}</div><div><br/></div><div>//获取全局变量</div><div>//获取到全局对象</div><div>VectorProductNumber=getFormProperty(&quot;vectorProductionNumber&quot;)</div><div><br/></div><div>      if(VectorProductNumber.size()&gt;0)</div><div>      { </div><div>//循环拿出值</div><div>          ProductNumber= VectorProductNumber.get(0)</div><div>   //把值放入编辑框中</div><div>           editproducttype.setText(ProductNumber)</div><div>         </div><div>      }</div></span>
</div></body></html> 