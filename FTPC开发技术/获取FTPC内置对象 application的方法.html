<html>
<head>
  <title>获取FTPC内置对象 application的方法</title>
  <basefont face="微软雅黑" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/601302 (zh-CN, DDL); Windows/10.0.0 (Win64); EDAMVersion=V2;"/>
  <style>
    body, td {
      font-family: 微软雅黑;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="5041"/>
<h1>获取FTPC内置对象 application的方法</h1>

<div>
<span><div style="min-height: 12pt; text-align: left;">首先现在Ftpc--Applications 中拿到Applicationlitems</div><div style="min-height: 12pt; text-align: left;"><img src="获取FTPC内置对象 application的方法_files/Image.png" type="image/png" data-filename="Image.png"/><br/></div><div style="min-height: 12pt; text-align: left;">eclicep  中获取该名称的代码；</div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; color: rgb(18, 144, 195); font-size: 10.0pt; background: #373737;">Application</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(217, 232, 247); font-size: 10.0pt; background: #373737;"> </span> <span style="min-height: 12pt; font-family: Consolas; color: rgb(242, 242, 0); font-size: 10.0pt; background: #373737;">application</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(230, 230, 250); font-size: 10.0pt; background: #373737;">=</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(217, 232, 247); font-size: 10.0pt; background: #373737;"> </span> <span style="min-height: 12pt; font-family: Consolas; color: rgb(18, 144, 195); font-size: 10.0pt; background: #373737;">PCContext</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(230, 230, 250); font-size: 10.0pt; background: #373737;">.</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(150, 236, 63); font-size: 10.0pt; background: #373737; font-style: italic;">getFunctions</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(249, 250, 244); font-size: 10.0pt; background: #373737;">()</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(230, 230, 250); font-size: 10.0pt; background: #373737;">.</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(128, 246, 167); font-size: 10.0pt; background: #373737;">getApplication</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(249, 250, 244); font-size: 10.0pt; background: #373737;">(</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(23, 198, 163); font-size: 10.0pt; background: #373737;">&quot;MES_MASTER_CONFIGURATION&quot;</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(249, 250, 244); font-size: 10.0pt; background: #373737;">)</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(230, 230, 250); font-size: 10.0pt; background: #373737;">;</span><br/></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; color: rgb(230, 230, 250); font-size: 10.0pt; background: #373737;">然后找到下一个层级</span></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; color: rgb(230, 230, 250); font-size: 10.0pt; background: #373737;"><br/></span></div><div style="min-height: 12pt; text-align: left;"><span style="color: rgb(230, 230, 250); font-family: Consolas;"><img src="获取FTPC内置对象 application的方法_files/Image [1].png" type="image/png" data-filename="Image.png"/></span><br/></div><div style="min-height: 12pt; text-align: left;"><span style="font-family: Consolas;">eclicep 中找到下一层及的方法：</span></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; color: rgb(18, 144, 195); font-size: 10.0pt; background: #373737;">ConfigurationProperty</span> <span style="min-height: 12pt; font-family: Consolas; color: rgb(242, 242, 0); font-size: 10.0pt; background: #373737;">configurationProperty</span> <span style="min-height: 12pt; font-family: Consolas; color: rgb(230, 230, 250); font-size: 10.0pt; background: #373737;">=</span> <span style="min-height: 12pt; font-family: Consolas; color: rgb(243, 236, 121); font-size: 10.0pt; background: #373737;">application</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(230, 230, 250); font-size: 10.0pt; background: #373737;">.</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(167, 236, 33); font-size: 10.0pt; background: #373737;">getConfigurationProperty</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(249, 250, 244); font-size: 10.0pt; background: #373737;">(</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(23, 198, 163); font-size: 10.0pt; background: #373737;">&quot;BDC_OUT_WBS_MUMBER&quot;</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(249, 250, 244); font-size: 10.0pt; background: #373737;">)</span><span style="min-height: 12pt; font-family: Consolas; color: rgb(230, 230, 250); font-size: 10.0pt; background: #373737;">;</span><span style="font-family: Consolas;"><br/></span></div><div style="min-height: 12pt; text-align: left;">获取改配置项的值</div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">if</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">(</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">configurationProperty</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">!=</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">null</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">)</span></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">                    </span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">{</span></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">                           </span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">calcNum</span> <span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">=</span> <span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">(</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">Long</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">)</span> <span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">configurationProperty</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">.</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">getValue</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">()</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">;</span></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">                           </span></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">                    </span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">}</span></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">                    </span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">return</span> <span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">calcNum</span><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">;</span><br/></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;"><br/></span></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-family: Consolas; font-size: 10pt;">完整代码：</span></div><div style="min-height: 12pt; text-align: left;"><span style="font-family: Consolas;"><img src="获取FTPC内置对象 application的方法_files/Image [2].png" type="image/png" data-filename="Image.png"/></span><br/></div><div style="min-height: 12pt; text-align: left;"><span style="font-family: Consolas;"><br/></span></div><div style="min-height: 12pt; text-align: left;"><span style="font-family: Consolas;">+++++++++++++++++++++++++++++++++++++++++++++++++</span></div><div style="min-height: 12pt; text-align: left;"><span style="font-family: Consolas;">在eclicep中获取该配置项的方法；</span></div><div style="min-height: 12pt; text-align: left;"><span style="font-family: Consolas;"><br/></span></div><div style="min-height: 12pt; text-align: left;"><span style="min-height: 12pt; font-size: 10pt; color: rgb(249, 250, 244); font-family: Consolas;"><br/></span></div><div style="text-align: left;"><span style="font-family: Consolas;">import(&quot;<a href="http://com.datasweep.compatibility.client.applicationlogitem/">com.datasweep.compatibility.client.ApplicationLogItem</a>&quot;)</span></div><div style="text-align: left;"><span style="font-family: Consolas;">import(&quot;<a href="http://com.datasweep.compatibility.pnutsfunctions.applicationlogitem/">com.datasweep.compatibility.pnutsfunctions.applicationlogitem</a>&quot;)</span></div><div style="text-align: left;"><span style="font-family: Consolas;">//获取applicationItems</span></div><div style="text-align: left;"><span style="font-family: Consolas;">application = getApplication(MES_MASTER_CONFIGURATION)</span></div><div style="text-align: left;"><span style="font-family: Consolas;">//获取对象名词</span></div><div style="text-align: left;"><span style="font-family: Consolas;">vec= application.getConfigurationProperties()</span></div><div style="text-align: left;"><span style="font-family: Consolas;">//便利里面的所有属性  当属性名等于需要获取的名词时 则打印出这个值 并推出循环</span></div><div style="text-align: left;"><span style="font-family: Consolas;">for(i=0;i&lt;vec.length;i++)</span></div><div style="text-align: left;"><span style="font-family: Consolas;">{</span></div><div style="text-align: left;"><span style="font-family: Consolas;">   obj = vec[i]</span></div><div style="text-align: left;"><span style="font-family: Consolas;">   if(obj.toString() ==&quot;STM_QUERY_MAX_ROW&quot;)</span></div><div style="text-align: left;"><span style="font-family: Consolas;">   {</span></div><div style="text-align: left;"><span style="font-family: Consolas;">       objkey = obj.getValue()</span></div><div style="text-align: left;"><span style="font-family: Consolas;">       break;</span></div><div style="text-align: left;"><span style="font-family: Consolas;">   }</span></div><div style="text-align: left;"><span style="font-family: Consolas;">}</span></div><div style="min-height: 12pt; text-align: left;"><span style="font-family: Consolas;">println(objkey)</span><br/></div></span>
</div></body></html> 